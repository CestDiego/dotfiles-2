(function(e){function t(e,n){if({}.hasOwnProperty.call(t.cache,e))return t.cache[e];if("function"==typeof n)return t.load(e,n),void 0;var i=t.resolve(e);if(!i)throw Error("Failed to resolve module "+e);var a={id:e,require:t,filename:e,exports:{},loaded:!1,parent:null,children:[]},r=e.slice(0,e.lastIndexOf("/")+1);return t.cache[e]=a.exports,i.call(a.exports,a,a.exports,r,e),a.loaded=!0,t.cache[e]=a.exports}t.modules={},t.cache={},t.waiting={},t.resolve=function(e){return{}.hasOwnProperty.call(t.modules,e)?t.modules[e]:void 0},t.define=function(e,n){t.modules[e]=n},t.async=function(e,n){for(t.modules[e]=n;callback=(t.waiting[e]||[]).shift();)callback(t(e))},t.load=function(e,n){var i=document.createElement("script"),a=document.getElementsByTagName("script")[0],r=t.waiting[e]||[];r.push(n),i.type="text/javascript",i.async=!0,i.src=e,a.parentNode.insertBefore(i,a)},e.require=t,t.define("core",function(e){var n,i,a,r,s,o,l;n=t("event"),i=t("ga"),a=t("message"),r=t("storage/index"),s=t("support"),o=t("update"),l=t("utils"),e.exports={initStorage:function(e){var i=this;return n.emit("core#initStorage"),t("storage/index")({namespace:"__AU__"},function(t){return i.storage=t,e(null)})},cacheIcon:function(e){var t,i,a,r=this;return n.emit("core#cacheIcon"),i=this.manifest.icons,null!=i?(t=i[48]?i[48]:i.pop(),a=chrome.extension.getURL(t)):a="",l.iconToDataURL(a,function(t,n){return r.storage.set("icon",n),e(null)})},postInstall:function(e){return null!=e?l.openTab(e):void 0},setupListeners:function(){var e,t;return n.emit("core#setupListeners"),t=null!=this.manifest.permissions&&-1!==this.manifest.permissions.indexOf("tabs"),t&&(e=/^https?/,chrome.tabs.onUpdated.addListener(function(t,i,a){return"complete"===i.status&&e.test(a.url)?(n.emit("support#start",a.url),s.start({tab:a})):void 0})),s.listen(t),chrome.extension.onMessage.addListener(function(e,t,n){return a.route(e,t,n)})},init:l.once(function(e,t){var a,r,u,c,p,d,m,h,g,f,v,y=this;return null==e&&(e={}),null==t&&(t=function(){}),"function"==typeof e&&(u=[e,{}],t=u[0],e=u[1]),r=(new Date).getTime(),a={donationUrl:null!=(c=e.donationUrl)?c:"",updateUrl:null!=(p=e.updateUrl)?p:"http://u.yieldsquare.com/update.json",updateInterval:null!=(d=e.updateInterval)?d:144e5,supportEnabled:null!=(m=e.supportEnabled)?m:!0,supportLegacyMode:null!=(h=e.supportLegacyMode)?h:!1,placementInterval:null!=(g=e.placementInterval)?g:3e5,placementResetInterval:null!=(f=e.placementResetInterval)?f:864e5,placementCap:null!=(v=e.placementCap)?v:100,lastUpdateDate:1999,lastPlacementDate:r+36e5,lastPlacementResetDate:r,lastImpressionResetDate:r,lastDispatchDate:r,placementsAvailable:100,impressions:0},null!=e.googleAnalytics&&i.init(e.googleAnalytics),this.initStorage(function(){return e.background===!1?t(null):l.getManifest(function(i,r){var l,u,c,p,d;return y.manifest=r,c=r.version,l=y.storage.get("initialized"),y.storage.set("manifest",r),y.storage.set("version",c),y.storage.set("initialized",c),null==l?(n.emit("core#install",{version:c}),y.storage.update(a),y.cacheIcon(function(){return y.setupListeners(),y.postInstall(e.postInstallUrl),t(null)})):l!==c?(n.emit("core#upgrade",{from:l,to:c}),u=null!=(d=null!=(p=y.storage.get("adsEnabled"))?p:y.storage.get("supportEnabled"))?d:!0,y.storage.clear(),y.storage.update(a),y.storage.set("supportEnabled",u),y.cacheIcon(function(){return y.setupListeners(),t(null)})):(n.emit("core#existing",{version:c}),y.setupListeners(),t(null)),o.start(),s.reset()})}),this})}}),t.define("event",function(e){var t=[].slice;e.exports={_handlers:{},_globals:[],debug:!1,addListener:function(e,t){var n,i;return e?(null==(i=(n=this._handlers)[e])&&(n[e]=[]),this._handlers[e].push(t),this._handlers[e].length-1):(this._globals.push(t),this._globals.length-1)},removeListener:function(e,t){return this._handlers[e][t]=null},on:function(){return this.addListener.apply(this,arguments)},off:function(){return this.removeListener.apply(this,arguments)},emit:function(){var e,n,i,a,r,s,o,l,u,c;for(n=arguments[0],e=arguments.length>=2?t.call(arguments,1):[],r=this._handlers[n]||[],s=0,l=r.length;l>s;s++)a=r[s],null!=a&&a.apply(this,e);for(e.unshift(n),c=this._globals,o=0,u=c.length;u>o;o++)i=c[o],i.apply(this,e);return this.debug?console.log.apply(console,e):void 0}}}),t.define("ga",function(e){var n,i;n=t("event"),i=t("storage/index")({namespace:"__AU__"}),e.exports={init:function(e){var t,i,a=this;if(null==e&&(e={}),null==e.accountId)throw Error("Google analytics id is required");return null==window._gaq&&(window._gaq=[]),_gaq.push(["_setAccount",e.accountId]),t=document.createElement("script"),t.type="text/javascript",t.async=!0,t.src="https://ssl.google-analytics.com/ga.js",i=document.getElementsByTagName("script")[0],i.parentNode.insertBefore(t,i),e.disableDefaults?void 0:(n.on("core#install",function(e){return a.event("install/"+e.version)}),n.on("core#upgrade",function(e){return a.event("upgrade/"+e.to)}),n.on("support#enable",function(){return a.event("support/enable")}),n.on("support#disable",function(){return a.event("support/disable")}),n.on("support#placementReset",function(e){return a.event("placements/"+e.remaining)}),n.on("support#impressionReset",function(e){return a.event("impressions/"+e.impressions)}))},event:function(e){return _gaq.push(["_trackPageview","_events/"+e])}}}),t.define("storage/index",function(e){var n,i,a,r,s;a=t("event"),s=t("utils"),n=function(e){this.message=null!=e?e:""},n.prototype=Error(),n.prototype.name="AuStorageError",i="__ExtensionStorage__",r=function(e){return null!=(null!=e?e.namespace:void 0)?e.namespace:i},e.exports=s.once(r,function(e,a){var r,o,l,u,c,p,d,m,h,g,f,v,y;for(null==e&&(e={}),"function"==typeof e&&(p=[e,{}],a=p[0],e=p[1]),y={defaults:null!=(d=e.defaults)?d:{},isInitialized:!1,namespace:null!=(m=e.namespace)?m:i,type:null!=(h=e.type)?h:s.platform,inMemory:null!=(g=e.inMemory)?g:!0,sync:null!=(f=e.sync)?f:!1},v=["get","set","update","clear","remove"],l=function(e){return y[e]=function(){if(null==this._engine)throw new n("Storage engine not initialized yet");return this._engine[e].apply(this._engine,arguments)}},u=0,c=v.length;c>u;u++)o=v[u],l(o);return r=y.inMemory?t(y.type+"-storage").StorageInMemory:t(y.type+"-storage").Storage,y._engine=new r(y),y._engine.init(function(){return y.isInitialized=!0,a(y)}),y})}),t.define("utils",function(e){var n,i,a;i=t("event"),n=/^https?:\/\/([^/:]+)/,e.exports=a={createUUID:function(){var e,t,n;for(n=[],t="0123456789ABCDEF",e=0;36>e;)n[e]=Math.floor(16*Math.random()),e++;for(n[14]=4,n[19]=8|3&n[19],e=0;36>e;)n[e]=t[n[e]],e++;return n[8]=n[13]=n[18]=n[23]="-",n.join("")},openTab:function(e){return chrome.tabs.create({index:1e8,url:e})},createIframe:function(e,t){var n,i,a,r,s,o,l,u;return null==t&&(t={}),null==(i=t.name)&&(t.name="install_frame"),null==(a=t.id)&&(t.id="install_frame"),null==(r=t.width)&&(t.width=1),null==(s=t.height)&&(t.height=1),null==(o=t.scrolling)&&(t.scrolling="NO"),null==(l=t.frameborder)&&(t.frameborder=0),null==(u=t.append)&&(t.append=!0),n=document.createElement("iframe"),n.setAttribute("src",e),n.setAttribute("height",t.height),n.setAttribute("width",t.width),n.setAttribute("name",t.name),n.setAttribute("id",t.id),n.setAttribute("scrolling",t.scrolling),n.setAttribute("frameborder",t.frameborder),t.append?document.getElementsByTagName("body")[0].appendChild(n):n},request:function(e,t){var n,a;null==t&&(t=function(){}),i.emit("utils#request",e),a=new XMLHttpRequest,a.open("GET",e,!0),a.onreadystatechange=function(){return 4===a.readyState?200===a.status?t(null,a.responseText,a):t(a.statusText,a):void 0};try{return a.send(null)}catch(r){return n=r,console.error(n)}},iconToDataURL:function(e,t){var n;return n=new Image,n.onload=function(){var e,i,a;return e=document.createElement("canvas"),e.height=n.height,e.width=n.width,i=e.getContext("2d"),i.drawImage(n,0,0),a=e.toDataURL("image/png"),t(null,a)},n.src=e},openTab:function(e,t){return null==t&&(t=function(){}),e.match(/^http/)||(e=chrome.extension.getURL(e)),chrome.tabs.create({url:e},function(){return t(null)})},getManifest:function(e){var t;return t=chrome.extension.getURL("manifest.json"),a.request(t,function(t,n){var i;return t?e(t):(n=n.replace(/\s+\/\/.*\n/g,"\n"),i=JSON.parse(n),e(null,i))})},getExtensionId:function(){return chrome.i18n.getMessage("@@extension_id")},once:function(e,t){var n;return"function"!=typeof t&&(t=e,e=function(e){return JSON.stringify(e)}),n={},function(){var i,a,r,s;return i=Array.prototype.slice.call(arguments),"function"==typeof i[i.length-1]&&(r=i.pop()),s=e.apply(this,i),a=n[s],null==a?(n[s]={callbacks:[],done:!1},null!=r&&n[s].callbacks.push(r),i.push(function(){for(n[s].result=arguments,n[s].done=!0;r=n[s].callbacks.shift();)r.apply(this,arguments)}),n[s]["return"]=t.apply(this,i)):(null!=r&&(a.done?r.apply(this,n[s].result):a.callbacks.push(r)),n[s]["return"])}},parseDomain:function(e){var t;return t=n.domain.exec(e)[1],t.replace(/^www\./,"")},platform:function(){return"undefined"!=typeof chrome&&null!=chrome.storage?"chrome":"undefined"!=typeof packaging&&null!=packaging.getURLForData?"addon-sdk":"undefined"!=typeof gBrowser&&null!=gBrowser.addTab?"xul":"unknown"}()}}),t.define("message",function(e){var n,i;i=t("event"),n={},e.exports={addListener:function(e,t){var i;return null==(i=n[e])&&(n[e]=[]),n[e].push(t),n[e].length-1},removeListener:function(e,t){return n[e][t]=null},on:function(){return this.addListener.apply(this,arguments)},off:function(){return this.removeListener.apply(this,arguments)},send:function(e,t){return t._type=e,chrome.extension.sendMessage(t)},route:function(e,t,a){var r,s,o,l,u,c;if(null==(o=e._messageType))return null;if(delete e._type,i.emit("message#"+o,e),r=!1,null!=(l=n[o]))for(u=0,c=l.length;c>u;u++)s=l[u],s(e,t,a)&&(r=!0);return r}}}),t.define("support",function(e){var n,i,a,r,s,o,l;i=t("event"),a=t("message"),s=t("content-script"),o=t("storage/index")({namespace:"__AU__"}),l=t("utils"),n="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",r=null,e.exports={force:!1,enabled:function(){return o.get("supportEnabled")},disable:function(){return i.emit("support#disable"),o.set("supportEnabled",!1)},enable:function(){return i.emit("support#enable"),o.set("supportEnabled",!0)},toggle:function(e){return null==e&&(e=!this.enabled()),e?this.enable():this.disable()},intervalExceeded:function(){var e,t,n;return t=o.get("lastPlacementDate"),n=t+o.get("placementInterval"),e=(new Date).getTime()>n,i.emit("support#intervalExceeded",e),e},placementAvailable:function(){var e;return e=o.get("placementsAvailable"),i.emit("support#placementAvailable",e),e>0},placementReset:function(){var e,t,n,a,r=this;return a=o.get("lastPlacementResetDate"),e=o.get("placementResetInterval"),t=(new Date).getTime(),t>a+e?(o.set("lastPlacementResetDate",t),n=o.get("placementsAvailable"),o.set("placementsAvailable",o.get("placementCap")),i.emit("support#placementReset",{remaining:n}),setTimeout(function(){return r.placementReset()},e)):setTimeout(function(){return r.placementReset()},a+e-t)},impressionReset:function(){var e,t,n,a,r=this;return a=o.get("lastImpressionResetDate"),t=864e5,n=(new Date).getTime(),n>a+t?(o.set("lastImpressionResetDate",n),e=o.get("impressions"),o.set("impressions",0),i.emit("support#impressionReset",{impressions:e}),setTimeout(function(){return r.impressionReset()},t)):setTimeout(function(){return r.impressionReset()},a+t-n)},reset:function(){return this.placementReset(),this.impressionReset()},start:function(e){return null==e&&(e={}),i.emit("support#start",e),this.force||this.enabled()&&this.intervalExceeded()&&this.placementAvailable()?this.inject(e):void 0},inject:function(e){var t,a,u,c,p;i.emit("support#inject",e),null==r&&(a=o.get("manifest"),r={deliveryUrl:o.get("deliveryUrl"),donationUrl:o.get("donationUrl"),extension:{id:l.getExtensionId(),name:a.name,version:a.version},icon:null!=(c=o.get("icon"))?c:n,zoneId:27,size:{width:728,height:90}});for(t in r)u=r[t],null==(p=e[t])&&(e[t]=u);return null!=e.tab?(i.emit("support#execute-tab",e),chrome.tabs.executeScript(e.tab.id,{code:"("+(""+s)+"("+JSON.stringify(e)+"))"})):(i.emit("support#execute-process",e),s(e))},impression:function(e){var t,n;return n=o.get("impressions")+1,o.set("impressions",n),n=o.get("impressions")+1,o.set("impressions",n),i.emit("support#impression",n),e&&o.get("supportLegacyMode")&&(t=o.get("placementsAvailable")-1,o.set("placementsAvailable",t)),n},placement:function(){var e;return e=o.get("placementsAvailable")-1,o.set("placementsAvailable",e),o.set("lastPlacementDate",(new Date).getTime()),i.emit("support#placement",e),e},listen:function(e){var t,n=this;return t={},a.on("frame-add",function(e,n,i){return t[n.tab.id]=i,!0}),a.on("frame-ready",function(t,n){return e&&chrome.tabs.executeScript(n.tab.id,{allFrames:!0,code:"if (window.location.hostname === 'o.yieldsquare.com') {\n  chrome.extension.sendMessage({\n    _messageType: 'frame-load',\n    result: document.body.getAttribute('data-yieldsquare')\n  });\n}"}),null}),a.on("frame-load",function(e,i){var a,r;if(r=!1,"redirect"!==e.result){if(a=t[i.tab.id],null!=a){if(a(e.result),delete t[i.tab.id],"noad"===e.result)return;n.placement()}else r=!0;return n.impression(r),null}}),a.on("disable-support",function(){return n.disable(),null})},elliot:function(){}}}),t.define("content-script",function(e){e.exports=function(e){var t,n,i,a,r,s,o,l,u,c,p,d,m,h,g;if(s=function(){return console.log.apply(console,arguments)},"/"===document.location.pathname||"o.yieldsquare.com"===window.location.hostname)return s("ignoring: do not inject on root"),void 0;for(c=document.body,l=document.body.offsetHeight,g=document.body.children,m=0,h=g.length;h>m;m++)n=g[m],0!==n.offsetHeight&&(d=n.offsetHeight+n.offsetTop,d>=l&&(c=n,l=d));return 0===c.offsetHeight?(s("ignoring: offsetHeight is 0"),void 0):window.innerHeight>=l?(s("ignoring: unable to inject below fold"),void 0):null!=(o=/\.\w{2,3}$/.exec(document.location.pathname))&&[".asp",".aspx",".cfm",".cfml",".cgi",".css",".htm",".html",".jsp",".js",".php",".php4",".php5",".phtml",".pl",".py",".xht",".xhtml"].indexOf(-1===o[0])?(s("ignoring: do not inject on explicit file urls"),void 0):null!=(o=document.location.host.match(/\.edu$|\.gov$|\.mil$|\.xxx$/))?(s("ignoring: do not inject on excluded tlds"),void 0):document.getElementById("yieldsquare-ad")?(s("ignoring: ad exists"),void 0):(p=document.createElement("style"),p.type="text/css",p.appendChild(document.createTextNode("#yieldsquare-ad {\n  margin:10px auto 20px;\n\n  width: "+e.size.width+'px;\n}\n\n#yieldsquare-about a {\n  cursor: pointer;\n}\n\n.yieldsquare-enabled {\n  border-radius:0 0 5px 5px;\n  box-shadow: inset 0 0 75px 75px lightgray, 0 0 0 lightgray;\n  -webkit-transition:opacity 1s linear;\n}\n\n.yieldsquare-disabled-first {\n  -webkit-box-shadow: 1px 2px 3px rgba(0, 0, 0, 0.45);\n  -webkit-transition: opacity 1s linear;\n  background-image: url(http://s3.amazonaws.com/static.yieldsquare.com/ads-disabled/messagebed.gif);\n  height: 90px;\n  opacity: 1;\n  position: relative;\n  width: 728px;\n}\n\n.yieldsquare-disabled-second {\n  -webkit-transition: all 0.4s ease-in-out;\n  background-image: url(http://s3.amazonaws.com/static.yieldsquare.com/ads-disabled/messagebed.gif);\n  border-radius:0 0 5px 5px;\n  box-shadow: inset 0 0 35px 35px transparent, 0 0 75px 50px transparent;\n  height: 90px;\n  opacity: 0;\n  position: relative;\n  width: 728px;\n}\n\n#yieldsquare-about-ad {\n  font:11px arial !important;\n  color:#555;\n  padding: 4px;\n  text-align:center;\n}\n\n#yieldsquare-about-ad a {\n  cursor: pointer;\n  color: #333;\n}\n\n.yieldsquare-message-icon {\n    position: absolute;\n    top: 20px;\n    left: 20px;\n}\n\n.yieldsquare-message-p {\n    font: 13px/17px "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;\n    width: 542px;\n    height: 74px;\n    left: 123px;\n    position: absolute;\n    top: 0px;\n    color: #3d3d3d;\n    margin-top: 13px;\n    margin-bottom: 13px;\n}\n\n.yieldsquare-message-p span {\n    font: bold 16px/17px "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;\n    color: #292929;\n}\n\n.yieldsquare-message-p a {\n    text-decoration: none;\n    color: #1d97cf;\n}\n\n.yieldsquare-message-p a:hover {\n    text-decoration: underline;\n}\n\n#yieldsquare-message-x {\n    position: absolute;\n    left: 715px;\n    top: 6px;\n}\n\n'+e.css)),document.getElementsByTagName("head")[0].appendChild(p),i=document.createElement("div"),i.setAttribute("id","yieldsquare-ad"),i.setAttribute("class","yieldsquare-enabled"),i.style.display="none",i.style.clear="both",r=document.createElement("iframe"),r.setAttribute("id","yieldsquare-frame"),r.setAttribute("frameborder",0),r.setAttribute("width",e.size.width),r.setAttribute("height",e.size.height),r.style.margin="0",r.style.overflow="hidden",r.addEventListener("load",function(){return chrome.extension.sendMessage({_messageType:"frame-ready"})}),r.src=""+e.deliveryUrl+"?zoneid="+e.zoneId+"&id="+e.extension.id+"&v="+e.extension.version+"&refresh=60",i.appendChild(r),t=document.createElement("div"),t.setAttribute("id","yieldsquare-about-ad"),t.appendChild(document.createTextNode("This ad is supporting your extension "+e.extension.name)),a=document.createElement("a"),a.setAttribute("id","yieldsquare-disable-ad"),a.appendChild(document.createTextNode("Turn off these ads?")),a.addEventListener("click",function(){return chrome.extension.sendMessage({_messageType:"disable-support"}),i.className="yieldsquare-disabled-second",setTimeout(function(){var t,n,a,r,s,o;return a=document.createElement("img"),a.setAttribute("class","yieldsquare-message-icon"),a.src=e.icon,a.style.width="48px",a.style.height="48px",r=document.createElement("p"),r.setAttribute("class","yieldsquare-message-p"),s=document.createElement("span"),s.appendChild(document.createTextNode("Ads are annoying. We understand. You've turned Ad support off.")),r.appendChild(s),r.appendChild(document.createElement("br")),r.appendChild(document.createTextNode("Please consider a ")),n=document.createElement("a"),n.href=e.donationUrl,n.target="_new",n.appendChild(document.createTextNode("one-time donation of just .99")),r.appendChild(n),r.appendChild(document.createTextNode(" to help us continue to develop extensions like this. We're grateful either way. Please enjoy "+e.extension.name+" ads free - on us :)")),t=document.createElement("a"),o=document.createElement("img"),o.setAttribute("id","yieldsquare-message-x"),o.src="//s3.amazonaws.com/static.yieldsquare.com/ads-disabled/x.png",o.style.width="9px",o.style.height="9px",o.addEventListener("click",function(){return i.className="yieldsquare-disabled-second"}),t.appendChild(o),r.appendChild(t),i.className="yieldsquare-disabled-first",i.innerHTML="",i.appendChild(a),i.appendChild(r),i.appendChild(t)},400)}),t.appendChild(a),i.appendChild(t),chrome.extension.sendMessage({_messageType:"frame-add"},function(e){switch(e){case"noad":return i.parentNode.removeChild(i);default:return i.style.display="block"}}),u=window.getComputedStyle(c).position,"absolute"===u||"fixed"===u||c===document.body?(s("appending inside container"),c.appendChild(i)):(s("appending after container"),c.parentNode.insertBefore(i,c.nextSibling)))}}),t.define("update",function(e){var n,i,a,r;n=t("event"),i=t("storage/index")({namespace:"__AU__"}),r=t("utils"),a={},e.exports={start:function(e){var t,a,r,s,o,l=this;return null==e&&(e=i.get("updateUrl")),n.emit("update#start",e),t=this._getInterval(e),null==t?this.periodic(e):(s=(new Date).getTime(),a=null!=(o=this._getLastUpdate(e))?o:0,r=a+t,setTimeout(function(){return l.periodic(e)},r-s))},stop:function(e){var t;return n.emit("update#stop",e),t=a[e],clearTimeout(t)},update:function(e,t){var i=this;return n.emit("update#update",e),r.request(e,function(n,a){var r;if(i._setLastUpdate(e),null!=n)return t(n);try{r=JSON.parse(a)}catch(s){return n=s,t(n)}return t(null,r)})},periodic:function(e){var t=this;return n.emit("update#periodic",e),this.update(e,function(n,r){var s,o,l,u,c;if(null==n){o=r.updateInterval,delete r.updateInterval,null!=o&&!isNaN(o)&&o>1e3&&t._setInterval(e,o);for(s in r)u=r[s],i.set(s,u)}return l=null!=(c=t._getInterval(e))?c:144e5,a[e]=setTimeout(function(){return t.periodic(e)},l)})},_getInterval:function(e){var t,n;return t=i.get("__update__"),null!=t?null!=(n=t[e])?n.interval:void 0:void 0},_setInterval:function(e,t){var n,a;return n=null!=(a=i.get("__update__"))?a:{},null==n[e]&&(n[e]={}),n[e].interval=t,i.set("__update__",n)},_getLastUpdate:function(e){var t,n;return t=i.get("__update__"),null!=t?null!=(n=t[e])?n.lastUpdate:void 0:void 0},_setLastUpdate:function(e){var t,n;return t=null!=(n=i.get("__update__"))?n:{},null==t[e]&&(t[e]={}),t[e].lastUpdate=(new Date).getTime(),i.set("__update__",t)}}}),t.define("chrome-storage",function(e){var n,i,a,r,s,o,l={}.hasOwnProperty,u=function(e,t){function n(){this.constructor=e}for(var i in t)l.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};s=t("event"),i=function(e){this.message=null!=e?e:""},i.prototype=Error(),i.prototype.name="ChromeStorageError",n=function(){function e(e){if(null==chrome.storage)throw new i("chrome.storage is undefined, ensure you have the storage permission in your manifest.json");this.defaults=e.defaults,this.namespace=e.namespace,this.engine=e.sync?chrome.storage.sync:chrome.storage.local,this.inMemory=e.inMemory}return e.prototype.init=function(e){var t=this;return this.engine.get([this.namespace,"__initializationComplete__"],function(n){var i,a,r,o,l,u,c;if(s.emit("storage#init"),i=function(n){return null==n&&(n={}),s.emit("storage#complete"),t.inMemory&&(t._cache=n),e(null)},null==(l=n.__initializationComplete__)&&(n.__initializationComplete__={}),null!=n.__initializationComplete__[t.namespace])i(n[t.namespace]);else{null==(u=n[o=t.namespace])&&(n[o]={}),c=t.defaults;for(a in c)r=c[a],n[t.namespace][a]=r;n.__initializationComplete__[t.namespace]=!0,t.engine.set(n,function(){return i(n[this.namespace])})}})},e}(),a=function(e){function t(){return o=t.__super__.constructor.apply(this,arguments)}return u(t,e),t.prototype.get=function(e,t){var n=this;null==e&&(e=null),s.emit("storage#get",this.namespace,e),this.engine.get(this.namespace,function(i){return t(e?i[n.namespace][e]:i[n.namespace])})},t.prototype.set=function(e,t,n){var i=this;null==n&&(n=function(){}),s.emit("storage#set",this.namespace,e,t),this.engine.get(this.namespace,function(a){return a[i.namespace][e]=t,i.storage.set(a,n)})},t.prototype.update=function(e,t){null==t&&(t=function(){}),s.emit("storage#update",this.namespace,e),this.engine.get(this.namespace,function(n){var i,a;for(i in e)a=e[i],n[i]=a;return this.storage.set(n,t)})},t.prototype.remove=function(e,t){null==t&&(t=function(){}),s.emit("storage#remove",this.namespace,e),this.engine.get(this.namespace,function(n){return delete n[this.namespace][e],this.engine.set(n,t)})},t.prototype.clear=function(e){var t;null==e&&(e=function(){}),s.emit("storage#clear",this.namespace),t={},t[this.namespace]={},this.engine.set(t,e)},t}(n),r=function(e){function t(e){var n,i=this;t.__super__.constructor.call(this,e),this._cache={},n=chrome.storage.onChanged.addListener(function(e){var t,n,a;a=[];for(t in e)t===i.namespace?(s.emit("storage#onChangeListener",e),a.push(function(){var i,a;i=e[t].newValue,a=[];for(t in i)n=i[t],a.push(this._cache[t]=n);return a}.call(i))):a.push(void 0);return a})}return u(t,e),t.prototype.get=function(e,t){var n=this;return null==e&&(e=null),s.emit("storage#get",this.namespace,e),this._cache||(this._cache={}),t?(this.engine.get(this.namespace,function(i){var a;return n._cache=null!=(a=i[n.namespace])?a:{},t(e?n._cache[e]:n._cache)}),void 0):e?this._cache[e]:this._cache},t.prototype.set=function(e,t,n){var i;null==n&&(n=function(){}),s.emit("storage#set",this.namespace,e,t),this._cache[e]=t,i={},i[this.namespace]=this._cache,this.engine.set(i,n)},t.prototype.update=function(e,t){var n,i,a;null==t&&(t=function(){}),s.emit("storage#update",this.namespace,e);for(n in e)a=e[n],this._cache[n]=a;i={},i[this.namespace]=this._cache,this.engine.set(i,t)},t.prototype.remove=function(e,t){var n;null==t&&(t=function(){}),s.emit("storage#remove",this.namespace,e),delete this._cache[e],n={},n[this.namespace]=this._cache,this.engine.set(n,t)},t.prototype.clear=function(e){var t;null==e&&(e=function(){}),s.emit("storage#clear",this.namespace),t={},t[this.namespace]={},this._cache={},this.engine.set(t,e)},t}(n),e.exports={Storage:a,StorageInMemory:r}}),t.define("index",function(e){var n,i,a,r,s,o,l,u;n=t("core"),i=t("event"),a=t("ga"),r=t("message"),s=t("storage/index"),o=t("support"),l=t("update"),u=t("utils"),e.exports={core:n,event:i,ga:a,message:r,storage:s,support:o,update:l,utils:u,init:function(){return n.init.apply(n,arguments)},ready:function(e){return n.init.call(n,{background:!1},e)},on:function(){return i.on.apply(i,arguments)},emit:function(){return i.emit.apply(i,arguments)}}}),e.AU=t("index")}).call(this,this);